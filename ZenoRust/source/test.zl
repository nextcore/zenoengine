print("--- ZenoLang Database Test ---");

print("Creating table users...");
let create_sql = "CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, name TEXT)";
let res = db_execute(create_sql);
print("Table created (result): " + str(res));

print("Inserting users...");
db_execute("INSERT INTO users (name) VALUES (?)", ["Zeno"]);
db_execute("INSERT INTO users (name) VALUES (?)", ["Rust"]);

print("Querying users...");
let users = db_query("SELECT * FROM users");
print("Users found: " + str(len(users)));

// Print details
// users is an array of maps: [{"id": 1, "name": "Zeno"}, ...]
fn printUsers(list, idx) {
    if (idx < len(list)) {
        let u = list[idx];
        print("User " + str(u["id"]) + ": " + u["name"]);
        printUsers(list, idx + 1);
    }
}
printUsers(users, 0);
